# 饮食日记小程序
一款已上线、基于微信原生及云开发的饮食日记小程序，用于帮助炎症性肠病(IBD)患者记录每日饮食、症状等。

![foodDiary.jpeg](docs/images/foodDiary.jpeg)


## 技术选型
- 微信小程序原生组件及API
- 微信小程序云开发·数据库
- 微信小程序云开发·云函数


## 功能模块及技术点
完全基于微信小程序原生组件及API开发，css样式直接手写，不依赖框架，无服务器，使用小程序云开发创建请求接口，存储数据。不保存用户相关信息，如头像、昵称等资料。开发者工具里需要开启增强编译(方便使用async await)

- 首页，根据日期拉取饮食日记，用到了 **下拉刷新、scroll-view、自定义picker样式、请求数据缓存**
- 添加/修改/删除记录 用到了 **数组push、pop来标记是否进行了添加、修改删除操作**。便于成功后返回首页时刷新数据
- 我的页面，**利用open-data不需要用户授权点击，直接显示用户头像、昵称等信息**。还有**画比1px还细的线。改变原生button的样式，和其他列表样式显示一致**。
- 关于页面，**仿微信关于页面，集成检查新版本功能**
- 功能介绍，**仿微信更新日志，弄了一个通用的样式、格式来渲染对应的更新信息**。
- 其他：**iPad大屏兼容**、用rpx时注意，有些位置如高度、大屏显示会很别扭，**sitemap配置索引**，**配置某些页面是否可以转发，自定义转发路径、标题、图片**。云开发函数返回通用格式规划，**基于promise的通用云函数请求封装**，**错误提示处理**；云开发数据库，**集合数据的增删查改**；**数组sort自定义排序**；


## 历史日志
```
v1.1.0(2019-08-16 21:35)
  1. A 新增 iPad UI适配，将字体rpx，以及固定高度rpx改为px，优化大屏显示效果。iphone 5显示优化
  2. A 新增下拉刷新，弥补多端同步时，一端已缓存数据，另一端当天数据变更后，缓存的一端不会实时刷新的不足。
  3. A 新增网络异常提示，当检测没网络时，提示异常，但如果连接了wifi，但如果wifi也没网是无法检测的，只能等超时提示异常

v1.0.1(2019-08/16)
  1. A 新增 缓存数据，减少请求操作
  2. F 修复 修改记录时文案依旧是'新增记录'的问题，改为'修改记录'
  3. F 修复 饮食记录里按新增顺序排序，而不是按时间排序
  4. O 优化 饮食记录列表的key原来为时间，考虑后时间可以重复，key改为_id
  5. O 优化 提取request请求通用代码封装，开启增强编译，使用async await写法替换promise.then
  6. O 优化 首页每次onshow都会刷新数据的问题，仅在日期变更或新增、修改、删除记录返回页面时执行请求数据操作
  7. O 优化 暂无记录时，'添加一条记录' 的点击范围增大

v1.0.0 (2019/08/15)
  A 新增 基础功能，初始化项目
```


## 参考文档

- [微信小程序云开发文档](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/getting-started.html)

